<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">

  <link rel="canonical" href="http://localhost:4000/%E6%96%B9%E6%B3%95%E8%AE%BA-%E5%8D%8E%E4%B8%BA%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E5%AE%9E%E7%8E%B0%E8%8D%89%E6%A0%B9%E9%80%86%E8%A2%AD" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description" content="  作者：王占刚  来源：锐捷聚焦、蓝血研究  蓝血研究文章，如需转载请通过后台申请">

  <meta property="og:site_name" content="BertrandDigitalGarden">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-DBYSXF7WKD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DBYSXF7WKD');
  </script> -->
  
  <!-- 
  <script src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script>
  <link
    rel="stylesheet"
    href="https://unpkg.com/@waline/client@v2/dist/waline.css"
  />  
  -->
  
  
  <!-- <script async defer data-website-id="0dc17886-9c5c-4bb7-b097-104eb7c28c72" src="https://umami-production-7220.up.railway.app/umami.js"></script> -->
  
  
  <!-- Start of Howxm client code snippet -->
  <script>
  function _howxm(){_howxmQueue.push(arguments)}
  window._howxmQueue=window._howxmQueue||[];
  _howxm('setAppID','352e66d3-cc84-42ce-ac80-a43a12abf84b');
  (function(){var scriptId='howxm_script';
  if(!document.getElementById(scriptId)){
  var e=document.createElement('script'),
  t=document.getElementsByTagName('script')[0];
  e.setAttribute('id',scriptId);
  e.type='text/javascript';e.async=!0;
  e.src='https://static.howxm.com/sdk.js';
  t.parentNode.insertBefore(e,t)}})();
  </script>
  <!-- End of Howxm client code snippet -->
  
  <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "jurm89uqvq");
  </script>
  
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">

  <link rel="stylesheet" href="/styles.css">

  
  <meta property="og:description" content="  作者：王占刚  来源：锐捷聚焦、蓝血研究  蓝血研究文章，如需转载请通过后台申请"/>
  

  
  <meta property="og:title" content="【方法论】华为如何通过客户关系实现草根逆袭？">
  <meta property="og:type" content="article">
  

  
  <meta property="article:published_time" content="2024-03-09T23:52:57+08:00">
  <meta property="article:author" content="http://localhost:4000/">
  

  <meta property="og:url" content="http://localhost:4000/%E6%96%B9%E6%B3%95%E8%AE%BA-%E5%8D%8E%E4%B8%BA%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E5%AE%9E%E7%8E%B0%E8%8D%89%E6%A0%B9%E9%80%86%E8%A2%AD" />

  

  <title>
    
      【方法论】华为如何通过客户关系实现草根逆袭？ &mdash; BertrandDigitalGarden
    
  </title>
</head>

  <body>
    <nav><div>
    <a class="internal-link" href="/"><b>BertrandDigitalGarden</b></a>
</div></nav>
    <div class="wrapper">
      <main><article>
  <div>
    <h1>【方法论】华为如何通过客户关系实现草根逆袭？</h1>
    <!-- 更新时间一直都是显示为构建时间，先屏蔽 -->
    <time datetime="">
      最后更新于 
      
    </time> 
  </div>

  <div id="notes-entry-container">
    <content>
      <html><body>
<ul>
  <li>作者：王占刚</li>
  <li>来源：锐捷聚焦、蓝血研究</li>
  <li>蓝血研究文章，如需转载请通过后台申请</li>
</ul>

<p>客户关系管理是什么？它是企业的一种核心能力。我们的企业会面临着越来越复杂的，艰苦的市场环境，每年的增长对我们每个销售都有很大的压力，从未来来看，我们如何能够活得更好，活得更长久，这需要我们企业要不断的去构建新的能力，比我们的对手更强的能力，客户关系就是个很好的能力。</p>

<p>1</p>

<p>华为的客户关系管理是如何来的？</p>

<p>华为公司为什么把客户关系看的那么重，其中有一个很重要的原因，就是华为公司的起点特别低，他是真正一个草根逆袭的企业，从一个贸易公司起家，一无技术，二无人才，三无资金，初期的看家法宝就是我们的客户关系能力，任总对于华为早期的成功有一段比较经典的话：华为的产品也许不是最好的，但这又怎么样。什么是核心竞争力？选择我而没有选择你就是核心竞争力。</p>

<p>华为客户关系能力的构建，并非一开始就有一个完整的体系，也是先从工具方法层面先构建点的能力，来支撑我们个体的单兵作战以及小团队的作战，在这个期间，我们找到了三个好师傅，第一个是跟标杆学习，主要对标的是IBM，我们跟IBM学习了14年，很多模型，工具与方法，都是跟IBM学的；第二个是跟对手学，我们主要是跟爱立信学，比如客户经理的岗位职责之类的，我们是不断的从优秀的对手那里学习先进的经验，来弥补自己的短板；第三个是跟自己学，华为的客户关系管理当中凝聚了大量华为的自身实践。</p>

<p>一个企业最大的浪费是经验的浪费，其实每个企业都有很多优秀的人，有很多优秀的做法，但这些人的经验都存在自己的脑子里面，没有留下来，这是很可惜的。他们的经验如果不能传承下来，当这些人离开了华为以后，华为未来应该怎么走？所以我们就把这些人的经验通过案例，通过一些项目运作手段方法，不断的总结萃取，把它固化到我们的流程里面来，能力就逐渐强化起来了。到了08年，华为启动CRM变革项目群，对客户关系管理进行了增强，才成为一个完整的管理体系，包括为什么要做客户关系管理，它有什么价值？应该如何去做？应该如何去管？</p>
<ul>
  <li>To B类客户关系的特点</li>
</ul>

<p>中国是一个关系型的社会，盛行各种圈子文化，我们有亲戚关系、朋友关系、同学关系等等，客户关系跟别的关系相比来讲，它有非常大的特殊性。</p>

<p>第一是客户关系是一种功利性的关系，客户经理在工作中要摆正自己的位置，我们在客户关系过程当中，追求的是让客户感觉你是朋友，但是你不能真的认为客户是你的朋友，因为我们中间是有利益的，这个分寸要把握好，摆不正自己位置的人往往就会栽跟头。</p>

<p>第二是在应用场景上，我们的销售类型必须是可重复的和可持续的，它不是一次性销售。为什么在景区，或者是车站这种场景下，服务感受很差？因为这种场景的销售模式是流量销售，宰一个算一个，它不是做回头客的生意，不同的销售模式决定了客户服务的质量；如果客户那只有一个项目，从时间维度来看，人财物的投入的回报不高，我们也不会去做客户关系。</p>

<p>如果是重复的持续的销售，构建经营客户关系活动就会给我们带来非常大的收益。客户关系是一种投资。在企业的人财物有限的基础上，我们把有限的人财物投放到可以持续给我们带来价值的客户身上，所以就我们才要做这样的客户关系。对于to B类销售，每打进一个企业，搞定一个客户，是需要时间的，既然整个投入期比较长，如果好不容易进去之后，不能从它那里持续发掘出我们的价值，那我们的人均产出投入产出比和投资效率就不高，所以我们才强调说我们要把有限的资源放到最有价值的客户身上，然后把这个客户的价值最大化。</p>

<p>以华为来看的话，它的客户关系有两个非常明显的特点，第一它的客户是高度集中的。华为现在一年有6037亿的销售，它的客户其实只有几百家；第二个特点就是这些客户都是跟华为合作很多年的，像中国移动，中国电信这些企业，从华为成立就开始合作，到现在仍然是我们的客户。那么我们思考一个问题，在这30年当中，华为在这些客户身上投入的资源如果加起来会有多少？这种积累会形成对很多后来者的一个壁垒，也就导致这个市场会成为事实上的封闭市场。</p>

<p>2</p>

<p>客户关系管理能给企业带来什么价值？</p>

<p>客户关系管理流程是营销业务的重要支撑流程，属于一种附加能力，本身不能产生直接的价值，没有哪个客户会因为客户关系好，就直接把钱给你了，客户关系是帮我们做成我们想做的事儿。</p>

<p>从业务表现上来看，客户关系可以给我们带来四重收益：</p>

<p>第一重收益是支撑我们的盈利诉求，不要把订单都陷入到价格战里面去，做客户关系是希望能够支持公司盈利。也就是好像看起来相同的东西，我们能卖的比竞争对手贵。我们如何去实现这一点？这不是要我们去杀熟，因为客户关系好，所以卖的东西就比别人贵，如果是这样，从长期看我们会失去客户。</p>

<p>客户关系是构建我们与客户之间的信任，让我们能够把公司的综合实力向客户展示出来，充分呈现我们对客户带来的价值并获得客户的认可，说明贵是有道理的。如果客户不信任你，你展现的价值客户就不会接受，或者大打折扣。华为能够在这些年当中一直做到一点，我们在大部分项目中的商务可以比中兴高20%，客户认为是合理的，这20%有可能就是我的利润。我们去分析各行业的TOP客户，我还没找到哪家企业是因为价格最低而成为行业老大的。</p>

<p>第二，客户关系可以帮我们支持市场目标的达成。啥叫市场目标？它其实是分了三个目标，一个叫山头目标的突破，指的是新客户、新产品、新区域的进入，是需要客户关系提前去铺垫的，客户关系管理要先行；第二个是份额目标的持续提升，我们已经进去的客户，要持续提升我们的份额占比，今年份额占20%，我希望明年占到30%，这需要客户关系来支持我的份额诉求，要变得对客户更重要，愿意多买我们的东西。</p>

<p>第三个就是能够支持各种市场环境下业务的平稳增长。这个平稳的意思是当整个行业环境好的时候，我要过得挺好的。当整个行业环境不好的时候，我能够逆势而上，做到此消彼长。华为能成为运营商领域设备与服务的行业第一，与客户关系的支撑是分不开的。</p>

<p>第四个是支撑企业的竞争目标的持续实现。通信行业是一个竞争强度特别大的行业，有些对手对我们来讲已经变成一种你死我活的关系，它成为我的竞争对手的时候，我怎么能把他从我的客户当中赶出去，或者把它的价值压缩，靠的就是我们客户关系要给予支撑，没有客户的支持，你是没办法把对手赶出去的。</p>

<p>3</p>

<p>客户关系管理的核心是什么？</p>

<p>有些公司把客户关系片面的理解为吃吃喝喝，糖衣炮弹，这是对客户关系管理极大的误解，客户关系管理的核心价值在于能帮企业做正确的客户选择。我们很多公司在做客户关系的时候，眼睛里看的更多的是机会，是项目，而忽视了机会与项目背后的载体，是客户。没有任何一家企业可以服务所在行业中的所有客户，所以企业的经营活动是在用有限的资源去争取无限的市场机会，所有行业的客户分布都是金字塔型，高价值客户就像塔尖上明珠，所以企业需要在众多的客户当中进行选择，谁是我的客户？</p>

<p>我们对“谁是目标客户”的理解，也是经历了一个过程的，最开始任总提出的口号是，花钱买我们东西的才是我们的客户，我们应该把精力聚焦，不要去参加媒体采访，不要做秀；但是过了一段时间之后，我们觉得这种理解不对，为什么呢？因为华为公司有一个对人才吸引非常核心的东西，就是他的整个薪酬待遇给的比较好，华为也是做生意的公司，不是印钱的，能发出去的钱，一定要靠我们到市场上通过订单拿回来。</p>

<p>那应该如何提升组织的薪酬支付能力？我们在客户关系管理当中关注了两个非常重要的指标，叫做人均销售贡献和人均利润贡献，这是作为我们整个管理改善当中的很重要的点，企业如果人均销售贡献越大，人均利润贡献越大，它整个的薪酬支付能力就会很强。所以企业的目标客户，应该是能够支撑企业的人均销售贡献与人均利润贡献的客户。</p>

<p>在1995年的时候，任总在一次研发的会议上提出了一个口号：未来的通讯行业会三分天下，而华为会占到其中的一份。到了1996年，公司组织讨论，如果任老板说的是对的。那么我们反过来需要思考一个问题，如果华为真成为未来三分天下当中的一家，那我们的客户是谁？你未来的客户是谁？未来的客户和现在的客户是相同的吗？</p>

<p>驱动企业的变革，有两个很重要的思维方法，一个叫做站在客户看自己，另一个叫做站在未来看现在。客户选择的方法就是采用站在未来看现在。如果未来是这个样子的，你会发现现在大部分的客户并不是未来的目标客户，所以企业必须要向更高质量的客户去努力。这种从未来看现在的思维方式，可以把一个组织从舒适区拉出来，发现企业的不足。如果真的要做到全球前三，从当时的华为来看，能力差距非常大，所以在1996年我们做了第二件事情，就是按照任总的要求，我们开始梳理了全球100T的大客户名单。也就是全球最有钱的100个客户，我们认为这才是华为未来的目标客户；到了1998年，我们更进一步，选择了这100个客户当中的一个，也就是英国BT，开始做供应商认证。世界顶级的企业，在选择合作伙伴的时候，不是只看价格的，它有一个游戏规则，叫做短名单。这一类企业它只会针对自己认证过的短名单里面的企业发标，其他的企业价格再低，连投标的资格都没有，第一个门槛就是要进他的短名单。</p>

<p>华为用了整整两年的时间才做完了英国BT的供应商认证，这两年属于我们的战略投入，没有什么订单，但是这个认证对公司价值很大，我们按照英国BT对于供应商选择的标准来跟自己对照，相当于为公司进行了一次全面的体检，让我们认识到我们与世界一流企业的差距有多大。当完成了应该BT的供应商认证，华为公司就跳到了一片蓝海当中，是当时在这个全球大T当中唯一一家跟西方厂家争夺的中国厂家，我们有了自己的粮仓。</p>

<p>华为的企业价值观中有一句话叫做以客户为中心，它的源头就是要做正确的客户选择，以及围绕目标客户构建我们的客户关系。根据目标客户选择的标准，对客户进行分级管理，我们把客户分成了四级：S类客户、A类客户、B类客户和C类客户。S类客户就是战略客户，A类客户就是伙伴型客户，这两类是公司的重点客户；进行客户分级以后，对于战略客户和伙伴型客户，需要进行客户的深入洞察，我们要从原来的看项目、看机会的角度，转到站在客户的视角去了解客户的行业，分析与规划客户的业务，来判断客户未来的发展以及它未来发展的潜力。</p>

<p>以客户为中心是需要企业把工作重心转向客户，而不要被短期的机会与项目所诱惑。客户是土壤，而项目和机会是土壤上生长出来的庄稼，只要客户在，就不愁没收成。所以我们才强调客户选择的重要性，通过客户洞察，如果发现在客户未来的发展当中，客户的业务会高速增长以及这个客户的质量很高，我们有很多能给客户带来价值的机会，企业就应该加大对这一类客户的资源投入，因为如果投入的资源越多，获取的机会也就越多，就可以跟客户共同分享增长，成为一种共生的关系。</p>

<p>如果不分析客户的发展，只看今年的项目，我们就没办法提前去储备未来几年为客户提供优质服务的资源和能力。客户对我们的要求是逐年递增的，因为客户在持续进步，没有这种提前的投入，我们对客户的需求满足就会出现滞后性，就是客户今天告诉你我要啥，然后你回头准备资源去开发，等开发完之后那个东西已经过时了。 我们对于客户的洞察是希望企业具备对于未来的预判能力，对于客户需求和行业的分析，判断出一年以后客户会用这个产品、会需要这样的功能、会需要这样的性能，这样就可以提前进行开发，当明年客户需求爆发出来的时候，我已经有了现成的产品和解决方案，那这个商机就会被我们提前抓到，基于对客户的洞察，在公司内部进行资源的整合，提前准备为客户提供优质高效低成本的服务。</p>

<p>客户的满意不是对某个人满意，是公司的综合服务能力达到了客户的期望，客户才会忠诚于你。 所有客户舍弃我们的原因，都是对我们深深的失望，客户换合作伙伴也是有切换成本的，很多失望是长期的积怨，日积月累形成的。如果我们没有一个管理手段去管理客户的满意度，我们就会面临失去客户的风险。失去一个客户并不可怕，可怕的是你根本不知道他为什么会失去，这才是可怕的。所以华为的客户关系管理，把客户满意度也纳入到自己的管理里面，才能够实现客户为中心的理念以及保障公司的可持续增长。</p>

<p>很多公司现在也开始喊以客户为中心的口号，于是销售就跑过来，客户认为我们的东西贵了，要打折，你不答应就是不以客户为中心，以客户为中心成了一线申请特价的理由。那么我们思考一下，这是不是真正的以客户为中心？华为在以客户为中心当中其实有另一句话作补充。这句话是什么？以客户为中心，要以生存为底线。我们要用工程商人的视角来要求自己，如果一个企业赚不到钱，就失去了长期持续为我们客户提供优质服务的能力。小的事情可以让步，但是不能以战略方向上的利益做交换。</p>
<ul>
  <li>客户关系管理可以支持企业战略目标的实现</li>
</ul>

<p>企业发展过程当中一定要持续选择客户，客户是个抽象的概念，它不是指某一个具体的企业，我们的客户中有新兴的，也会有衰亡的，但是无论行业当中的客户如何变化，我们总能跟成功者站在一起，所以对客户的洞察是一个持续的过程，我们不断的基于洞察进行客户的选择调整，并且构建价值客户对我们的黏性。</p>

<p>对于企业而言，战略是企业资源有限的基础上进行的取舍，这是战略的核心价值，包括对目标客户的定位和选择，也没有绝对的好坏之分，奢侈品有奢侈品的卖法，快消品有快消品的卖法。华为采用的是大客户聚焦的客户选择方式，客户高度集中，它在客户价值金字塔当中，持续构建往上面走的能力。那么在这里我们思考一个问题，如果我们的80%的业务来自于五个核心客户，这对企业来说，是好事还是坏事？其实好坏都有。</p>

<p>我们先看好的方面：顶尖客户死的可能性相对来讲是少的，最大可能是变大或者变小，我们的客户关系是一种持续性投资，怎么能保证你的投资的有效性？就是这个客户能活得足够长，他要死了那你的投资就打水漂了。我们发展一个大客户，可能2到3年才能把量做起来，如果做进去之后它倒闭了，我们前面的投资就失败了。所以华为公司选客户的时候，选行业当中的Top客户，这些客户哪怕兼并重组，也不会直接倒闭，能保护我的投资，大客户的往往有大单，华为有的合同一笔就上亿美金，甚至10亿美金的合同都有，大单可以极大地提升我们的人均产出能力，从而也就支持了公司有比较高的薪酬支付能力。</p>

<p>坏的方面是虽然客户没有倒闭，但是它把我们给替换了，会对我们的业务产生很大的冲击，我们在客户身上的投入都浪费了，包括服务团队和扩充的产能等等。所以企业在战略选择中把目标客户定位为大客户，这是好的，但是如果企业没有能力控制它，那选择大客户可能就会成为企业的定时炸弹。对于很多企业而言最缺的是针对大客户的战略控制能力。战略控制能力是什么？就是客户不离开你的能力。</p>

<p>客户的黏性可以分三层来构建，第一层是影响客户的感知，客户跟我们的业务合作非常顺畅，无论是战略研讨、业务规划、销售、设备交付、售后维护，客户的评价都很好，我们给客户的感觉是舒服。这公司响应很快，人员素质很高，服务质量挺不错的，这只是第一层；第二个层次是我们能够帮客户成功，我们可以提升客户赚钱的能力，客户的感觉就不仅仅是舒服了，比如我们来看一下小米的手机，它用的是高通骁龙845芯片，这个芯片要500多块钱，虽然这个东西很贵，但是却是小米产品的核心卖点之一，可以支撑产品定比较高的售价。如果我们的产品能够成为客户的卖点之一，那客户对我们的依赖性就会极大的增强了，因为我们的产品让客户更具有市场竞争力。现在很多企业都开始关注业务创新、技术开发和专利等企业的硬实力，能不能把我们的专利转化成客户对外宣传当中的产品卖点？如果可以，你的价值就跳出了产品价格的价值了，你能让客户的产品有更高的溢价，能帮他赚钱；第三个层次是战略层面的，以及企业文化与价值观的契合，所谓志同才能道合，与客户共同构建面向未来的共识，合作才是长期可持续的，也是不会被轻易所替代的。</p>

<p>战略伙伴关系是客户关系的顶点，形成企业与客户之间共生的，门当户对的合作关系，这需求我们企业不断的修炼自己的内功，提升自己的能力，打铁也需要自身硬才行。比如说富士康跟苹果之间，是一种战略型伙伴关系，如果是因为苹果的原因，富士康产线停工了一天，苹果仍然需要为停滞的产线付钱。因为富士康产品制造的成本管理能力很强，品质、成本、质量控制能力可以达到最优，它是无法被取代的。如果你只是苹果的众多供应商之一，苹果停工一天不给你钱，你能怎么样？企业有了实力才能跟别人叫板。</p>

<p>客户的选择与分级是在对客户的深入洞察的基础上才能实现，客户洞察应该如何展开呐？首先是正确解读客户的发展战略，战略匹配度是客户选择的关键因素。</p>

<p>构建客户信息收集渠道：第一是构建外部渠道，行业商务咨询报告、客户的股东大会、分析师大会、投资人都可以；第二是构建内部渠道，客户的网站、内部的刊物、年报、客户侧我们的教练、包括友商，客户信息收集并非多神秘的东西，80%的信息都是可以通过公开渠道获得的。</p>

<p>分析客户的发展战略：首先是了解客户未来的战略，它的投资领域、业务范围、组织架构。为什么要这么分析？因为我们需求知道现在和未来我们能不能给客户带来价值，我们的产品与服务在客户的业务当中，是它的主航道还是边缘业务。如果客户侧与我们相关的产品与服务需求，只能占到客户整个采购的5%类似这种，也就是在客户那边属于边缘业务，我们的分析就得下沉，针对这个公司的分析必须要下沉到跟我们业务相关的部门再做展开分析才有用。虽然5%这种小业务，客户侧还是要有部门去操盘的，这个部门就会成为我重要的分析方向。华为由于是运营商的主流设备供应者，所以对企业是全面性的分析。</p>

<p>战略度匹配分析：对于客户的分析除了看现在的机会以外，还要分析未来3到5年客户的战略方向，有哪些跟我们是相关的。如果发现在未来发展方向上，客户跟我们的战略匹配是渐渐的背离的，那即使现在它对我的营收贡献很大，我也会把它定义为现金牛客户，对它整个的投资策略是逐步的资源收缩，将资源转移到高价值客户上面。我们通过持续分析客户，预测客户未来的发展，来提升我们自己适应环境的能力，不在一棵树上吊死，所以战略匹配度是我们选择客户当中的关键因素。</p>

<p>向华为学习</p>

<p>客户关系管理流程与重大销售项目管理运作</p>

<table>
  <tbody>
    <tr>
      <td>2018年11月3-4日</td>
      <td>深圳</td>
    </tr>
  </tbody>
</table>

<p>王占刚 原华为白俄罗斯COO、铁三角变革项目负责人</p>
</body></html>
    </content>

    <side style="font-size: 0.9em">
      <h3 style="margin-bottom: 1em">反向链接：</h3>
      

      <div style="font-size: 0.9em">
        <p>
          There are no notes linking to this note.
        </p>
      </div>
      
    </side>
  </div>
</article>

<!-- <hr> -->

<!-- 图谱的性能太差，先屏蔽了 --></main>
      <footer><!-- <script src="https://giscus.app/client.js"
        data-repo="oldwinter/knowledge-garden"
        data-repo-id="R_kgDOHT-NGQ"
        data-category="备发布站的评论系统"
        data-category-id="DIC_kwDOHT-NGc4CQ3PF"
        data-mapping="og:title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script> -->
</footer>
    </div>
    <!-- That file is not particularly elegant. This will need a refactor at some point. -->
<style>
  content a.internal-link {
    border-color: #8b88e6;
    background-color: #efefff;
  }

  #tooltip-wrapper {
    background: white;
    padding: 1em;
    border: 1px solid #ddd;
    border-radius: 4px;
    overflow: hidden;
    position: absolute;
    width: 400px;
    height: 400px; /* 悬浮卡片改高一点 */
    font-size: 0.8em;
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    opacity: 0;
    transition: opacity 100ms;
  }

  /* #tooltip-wrapper:after {
		content: "";
		position: absolute;
		z-index: 1;
		bottom: 0;
		left: 0;
		pointer-events: none;
		background-image: linear-gradient(to bottom, rgba(255,255,255, 0), rgba(255,255,255, 1) 90%);
		width: 100%;
		height: 75px;
  } */
</style>
<!-- 给悬浮预览卡片加滚动条。 -->
<div style="opacity: 0; display: none; overflow-y: scroll;" id='tooltip-wrapper'>
  <div id='tooltip-content'>
  </div>
</div>

<iframe style="display: none; height: 0; width: 0;" id='link-preview-iframe' src="">
</iframe>

<script>
  var opacityTimeout;
  var contentTimeout;
  var transitionDurationMs = 100;

  var iframe = document.getElementById('link-preview-iframe')
  var tooltipWrapper = document.getElementById('tooltip-wrapper')
  var tooltipContent = document.getElementById('tooltip-content')

  function hideTooltip() {
    opacityTimeout = setTimeout(function() {
      tooltipWrapper.style.opacity = 0;
      contentTimeout = setTimeout(function() {
        tooltipContent.innerHTML = '';
        tooltipWrapper.style.display = 'none';
      }, transitionDurationMs + 1);
    }, transitionDurationMs)
  }

  function showTooltip(event) {
    var elem = event.target;
    var elem_props = elem.getClientRects()[elem.getClientRects().length - 1];
    var top = window.pageYOffset || document.documentElement.scrollTop

    if (event.target.host === window.location.host) {
      iframe.src = event.target.href
      iframe.onload = function() {
        tooltipContentHtml = ''
        tooltipContentHtml += '<div style="font-weight: bold;">' + iframe.contentWindow.document.querySelector('h1').innerHTML + '</div>'
        tooltipContentHtml += iframe.contentWindow.document.querySelector('content').innerHTML

        tooltipContent.innerHTML = tooltipContentHtml

        tooltipWrapper.style.display = 'block';
        setTimeout(function() {
          tooltipWrapper.style.opacity = 1;
        }, 1)
      }

      tooltipWrapper.style.left = elem_props.left - (tooltipWrapper.offsetWidth / 2) + (elem_props.width / 2) + "px";
      if ((window.innerHeight - elem_props.top) < (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top - tooltipWrapper.offsetHeight - 10 + "px";
      } else if ((window.innerHeight - elem_props.top) > (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top + 35 + "px";
      }

      if ((elem_props.left + (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = "10px";
      } else if ((document.body.clientWidth - elem_props.left - (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = document.body.clientWidth - tooltipWrapper.offsetWidth - 20 + "px";
      }
    }
  }

  function setupListeners(linkElement) {
    linkElement.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('touchend', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('touchend', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
      showTooltip(event);
    });

    tooltipWrapper.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
    });
  }

  document.querySelectorAll('content a').forEach(setupListeners);
</script>

  </body>
</html>
